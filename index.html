<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Chatbot</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div id="main-chatbot">
        <div id="container-chatbot" class="main-chatbot-close">

            <div class="relative-chatbot">
                <!-- Header du chatbot -->
                <div id='header-chatbot' class="header-chatbot">
                    <div class="back-header-chatbot" onclick="ouvertureFermutureChatbot()"></div>
                    <div class="img-header-chatbot" style="background-image: url('src/img/main-picture.png');">
                        <div style="background-color: #18A93F;">

                        </div>
                    </div>
                    <div class="text-header-chatbot">
                        <h1>Marie Victoire</h1>
                        <p>Votre conseillère en oenologie</p>
                    </div>
                    <div class="setting-header-chatbot" onClick="afficheSettingUser()"></div>
                </div>
                <!-- Zone d'affichage des messages -->
                <div id="message-content-chatbot" class="message-content-chatbot">

                    <!-- Première section d'affichage -->
                    <div class="first-view-presentation">
                        <div class="image-firstview"></div>
                        <div class="text-firstview">
                            <h1>Marie Victoire</h1>
                            <p>Votre conseillère en oenologie</p>
                        </div>
                    </div>

                </div>
                <!-- Zone d'envoi du texte -->
                <div class="input-text-message-chatbot">
                    <textarea id="contenu-message"></textarea>
                    <div><button id='button-submit'></button></div>
                </div>


                <!-- Modal de setting -->
                <div id="modal-setting-user" class="modal-setting-user-close">
                    <div class="cross-modal-setting-user" onclick="afficheSettingUser()"></div>
                    <h1>Réglage du chatbot</h1>
                    <p onclick="deleteChatBot()" class="unable-chatbot">Déactiver le Chat-Bot</p>
                    <div class="content-setting-user">
                        <p>Thème du chatbot</p>
                        <div class="row-theme-setting-user">
                            <div id="#202020" class="active" onclick="changeTheme('#202020')"
                                style='background-color: #202020;'></div>
                            <div id="#7CB66A" onClick="changeTheme('#7CB66A')" style='background-color: #7CB66A;'></div>
                            <div id="#88D9E5" onClick="changeTheme('#88D9E5')" style='background-color: #88D9E5;'></div>
                            <div id="#F7ACAC" onClick="changeTheme('#F7ACAC')" style='background-color: #F7ACAC;'></div>
                        </div>
                    </div>
                    <div class="content-setting-user">
                        <p>Taille des textes du chatbot</p>
                        <div class="row-theme-setting-user-size">
                            <input value="14" onchange="setUserSize()" type="number" id="sizeTextChatBot">
                            <p>px</p>
                        </div>
                    </div>

                </div>
            </div>

        </div>

        <div id="container-chatbot-img" onClick="ouvertureFermutureChatbot()" class="container-chatbot-close">

            <div class="img-perso-chatbot" style=" background-image: url('src/img/main-picture.png');">
                <div id="cross-img-perso-chatbot" class="cross-img-perso-chatbot">
                </div>
                <div class="message-chatbot-close">
                    <p>Puis-je vous être utile ?</p>
                </div>
            </div>


        </div>

    </div>


    <section></section>
    <section>

    </section>
</body>

</html>

<script>

    //Au lancement de la page
    document.addEventListener('DOMContentLoaded', function () {

        //setTimeout(ouvertureFermutureChatbot, 5000);

        etatlancement = 1;
    });

    //affichage du chatbot
    function ouvertureFermutureChatbot() {

        if (document.getElementById('container-chatbot-img').className == 'container-chatbot-close') {
            document.getElementById('container-chatbot-img').classList.remove('container-chatbot-close');
            document.getElementById('container-chatbot-img').classList.add('container-chatbot-open');

            document.getElementById('container-chatbot').classList.remove('main-chatbot-close');
            document.getElementById('container-chatbot').classList.add('main-chatbot-open');

            messageContentChatBot = document.getElementById('message-content-chatbot');
            messageContentChatBot.scrollTop = messageContentChatBot.scrollHeight;

            if (etatlancement == 1) {
                setTimeout(lancementBot, 3000);
                etatlancement = 0;
            }

        } else {
            document.getElementById('container-chatbot-img').classList.add('container-chatbot-close');
            document.getElementById('container-chatbot-img').classList.remove('container-chatbot-open');

            document.getElementById('container-chatbot').classList.add('main-chatbot-close');
            document.getElementById('container-chatbot').classList.remove('main-chatbot-open');

            messageContentChatBot = document.getElementById('message-content-chatbot');
            messageContentChatBot.scrollTop = messageContentChatBot.scrollHeight;


        }
    }

    //Envoi message
    document.getElementById("button-submit").addEventListener("click", function () {

        if (document.getElementById('contenu-message').value != 'full-display') {

            var div = document.createElement("div");
            div.className = "message-chatbot container-message-user";
            div.innerHTML = "<div><p id='text-message' style='font-size:14px;'>" + document.getElementById('contenu-message').value + "</p></div><p class='date-message'>4 : 53 PM</p>";
            document.getElementById("message-content-chatbot").appendChild(div);

            document.getElementById('contenu-message').value = '';

        } else {
            //Message d'un utilisateur
            var userMessage = document.createElement("div");
            userMessage.className = "message-chatbot container-message-user";
            userMessage.innerHTML = "<div><p id='text-message' style='font-size:14px;'>" + document.getElementById('contenu-message').value + "</p></div><p class='date-message'>4 : 53 PM</p>";
            document.getElementById("message-content-chatbot").appendChild(userMessage);


            //Message d'alerte du chatBot
            var alertMessage = document.createElement("div");
            alertMessage.className = "message-chatbot container-message-chatbot-alert";
            alertMessage.innerHTML = "<div><p id='text-message' style='font-size:14px;'>En général, à quels occasions buvez vous du vin ? Sélectionnez une étiquette ou répondez directement dans la zone de saisi</p></div><p class='date-message'>4 : 53 PM</p>";
            document.getElementById("message-content-chatbot").appendChild(alertMessage);

            //Conteneur des couleur du vin
            var conteneurCouleur = document.createElement("div");
            conteneurCouleur.className = "container-categorie-vin";
            conteneurCouleur.innerHTML = "<div id='box-categorie-1' class='box-categorie-vin'><div style='background-image: url(src/produit/rose.png);'></div><p>Rosé</p><input type='checkbox' id='categorie-1' onchange='changeCouleur(1)'></div><div id='box-categorie-2' class='box-categorie-vin'><div style='background-image: url(src/produit/vin-blanc.png);'></div><p>Blanc</p><input type='checkbox' id='categorie-2' onchange='changeCouleur(2)'></div><div id='box-categorie-3' class='box-categorie-vin'><div style='background-image: url(src/produit/rouge.png);'></div><p>Rouge</p><input type='checkbox' id='categorie-3' onchange='changeCouleur(3)'></div>";
            document.getElementById("message-content-chatbot").appendChild(conteneurCouleur);

            //Conteneur des button
            var conteneurButton = document.createElement("div");
            conteneurButton.className = "button-list-view";
            conteneurButton.innerHTML = "<div id='button-1'><input type='checkbox'  onclick='selectButton(1)'/><p>Végétal</p></div><div id='button-2'><input type='checkbox'  onclick='selectButton(2)'/><p>Fruité</p></div><div id='button-3'><input type='checkbox'  onclick='selectButton(3)'/><p>Floral</p></div><div id='button-4'><input type='checkbox'  onclick='selectButton(4)'/><p>Empyromatique</p></div><div id='button-5'><input type='checkbox'  onclick='selectButton(5)'/><p>Epice aromate</p></div>";
            document.getElementById("message-content-chatbot").appendChild(conteneurButton);

            //Conteneur des marque
            var conteneurMarque = document.createElement("div");
            conteneurMarque.className = "container-marque-vin";
            conteneurMarque.innerHTML = "<div id='box-marque-1' class='box-marque-vin'><div style='background-image: url(src/marque/sainte-roseline.png);'></div><input type='checkbox' id='marque-1' onchange='changeMarque(1)'></div><div id='box-marque-2' class='box-marque-vin'><div style='background-image: url(src/marque/demoiselles.png);'></div><input type='checkbox' id='marque-2' onchange='changeMarque(2)'></div>";
            document.getElementById("message-content-chatbot").appendChild(conteneurMarque);

            document.getElementById('contenu-message').value = '';
        }
    });

    //ChatBot delete
    function deleteChatBot() {
        document.getElementById('main-chatbot').style.display = "none";
    }

    //Affiche setting
    function afficheSettingUser() {
        if (document.getElementById('modal-setting-user').className == 'modal-setting-user-close') {
            document.getElementById('modal-setting-user').classList.add('modal-setting-user-open');
            document.getElementById('modal-setting-user').classList.remove('modal-setting-user-close');
        } else {
            document.getElementById('modal-setting-user').classList.remove('modal-setting-user-open');
            document.getElementById('modal-setting-user').classList.add('modal-setting-user-close');
        }
    }

    //Setting user change theme
    function changeTheme(color) {
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }
        rgb = document.getElementById('header-chatbot').style.backgroundColor.split(',');
        r = parseInt(rgb[0].substring(4));
        g = parseInt(rgb[1]);
        b = parseInt(rgb[2]);
        oldColor = rgbToHex(r, g, b);

        document.getElementById('header-chatbot').style.backgroundColor = color;
        document.getElementById(color).classList.add('active');
        document.getElementById(oldColor.toUpperCase()).classList.remove('active');
    }

    //Set text size
    function setUserSize() {

        size = document.getElementById('sizeTextChatBot').value;
        newSize = size + 'px';

        var elms = document.querySelectorAll("[id='text-message']");

        for (var i = 0; i < elms.length; i++) {
            elms[i].setAttribute("style", "font-size: " + newSize + ";");

        }



    }

    //Bouton de catégorie du vin
    function changeCouleur(i) {
        if (document.getElementById('categorie-' + i).checked == false) {
            document.getElementById('box-categorie-' + i).classList.remove('box-categorie-active');
            document.getElementById('box-categorie-' + i).classList.add('box-categorie-vin');
        } else {
            document.getElementById('box-categorie-' + i).classList.add('box-categorie-active');
            document.getElementById('box-categorie-' + i).classList.remove('box-categorie-vin');
        }
    }

    //Bouton des marques
    function changeMarque(i) {
        if (document.getElementById('marque-' + i).checked == false) {
            document.getElementById('box-marque-' + i).classList.remove('box-marque-active');
            document.getElementById('box-marque-' + i).classList.add('box-marque-vin');
        } else {
            document.getElementById('box-marque-' + i).classList.add('box-marque-active');
            document.getElementById('box-marque-' + i).classList.remove('box-marque-vin');
        }
    }

    //Lancement du chatbot
    function lancementBot() {
        document.getElementById('message-content-chatbot').innerHTML = "<p class='datetime-chatbot'> Mercredi 13 oct</p><div class='message-chatbot container-message-chatbot'><div><p id='text-message' style='font-size:14px;'>En général, à quels occasions buvez vous du vin ? Sélectionnez une étiquette ou répondez directement <a>dans la zone de saisi</a></p></div><p class='date-message'>4 : 53 PM</p></div>";
    }

    //Les selection de bouton
    function selectButton(num) {
        if (document.getElementById('button-' + num).className == "active") {
            document.getElementById('button-' + num).classList.remove('active');
        } else {
            document.getElementById('button-' + num).classList.add('active');
        }

    }



</script>